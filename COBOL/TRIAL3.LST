     1	      IDENTIFICATION DIVISION.							15NOV25 07:46:38  PAGE	  1
     2	      PROGRAM-ID.      SALE.
     3	     *AUTHOR.	      ALET.
     4	     *INSTALLATION.   S-305.
     5	     *DATE-WRITTEN.   NOVEMBER 19,2008.
     6	     *DATE-COMPILED.  NOVEMBER 19,2008.
     7	     *SECURITY.       EXCLUSIVE FOR US.
     8	     *REMARKS	      FIRST PROGRAM.
     9	      ENVIRONMENT DIVISION.
    10	      CONFIGURATION SECTION.
    11	      SOURCE-COMPUTER.	 IBM-PC.
    12	      OBJECT-COMPUTER.	 IBM-PC.
    13	      INPUT-OUTPUT SECTION.
    14	      FILE-CONTROL.
    15            SELECT INFILE ASSIGN TO 'SALES.txt'.
    16            SELECT OUTFILE ASSIGN TO 'BENTA'.
    17
    18	      DATA DIVISION.
    19	      FILE SECTION.
    20	      FD INFILE
    21		  LABEL RECORD IS STANDARD
    22		  RECORD CONTAINS 38 CHARACTERS
    23		  DATA RECORD IS INREC.
    24	      01  INREC.
    25		  02  AC	  PIC  X.
    26		  02  SNO	  PIC  9(5).
    27		  02  SNA.
    28		      05 FN	  PIC X(10).
    29		      05 MN	  PIC X(5).
    30		      05 LN	  PIC X(10).
    31		  02  AMT	  PIC  9(5)V99.
    32
    33	      FD  OUTFILE
    34		  LABEL RECORD IS OMITTED
    35		  DATA RECORD IS OUTREC.
    36	      01  OUTREC.
    37		  02  FILLER	  PIC X(80).
    38
    39	      WORKING-STORAGE SECTION.
    40	      01  SVAC		  PIC	X	VALUE SPACES.
    41	      01  TNS		  PIC	9(4)	VALUE ZERO.
    42	      01  TA		  PIC	9(7)V99 VALUE ZERO.
    43	      01  EOFSW 	  PIC	9	VALUE ZERO.
    44
    45	      01  HEAD-1.
    46		  02  FILLER  PIC X(29)     VALUE SPACES.
    47	     * FIX: VALUE MUST BE ON A SINGLE LINE
    48            02  FILLER  PIC X(22)     VALUE 'SAN MIGUEL CORPORATION'.
    49		  02  FILLER  PIC X(29)     VALUE SPACES.
    50	      01  HEAD-2.
    51		  02  FILLER  PIC X(31)     VALUE SPACES.
    52	     * FIX: VALUE MUST BE ON A SINGLE LINE
    53            02  FILLER  PIC X(17)     VALUE 'STA. MESA, MANILA'.
    54		  02  FILLER  PIC X(32)     VALUE SPACES.
    55	      01  SUB-1.
    56		  02 FILLER   PIC X(34)     VALUE SPACES.
    57            02 FILLER   PIC X(12)     VALUE 'SALES REPORT'.
    58		  02 FILLER   PIC X(34)     VALUE SPACES.
    59	      01  SUB-2.
    60		  02 FILLER   PIC X(7)	    VALUE SPACES.    61            02 FILLER   PIC X(4)      VALUE 'AREA'.                               15NOV25 07:46:38  PAGE    2
    62		  02 FILLER   PIC X(7)	    VALUE SPACES.
    63            02 FILLER   PIC X(8)      VALUE 'SALESMAN'.
    64		  02 FILLER   PIC X(16)     VALUE SPACES.
    65            02 FILLER   PIC X(8)      VALUE 'SALESMAN'.
    66		  02 FILLER   PIC X(15)     VALUE SPACES.
    67            02 FILLER   PIC X(6)      VALUE 'AMOUNT'.
    68		  02 FILLER   PIC X(9)	    VALUE SPACES.
    69	      01  SUB-3.
    70		  02 FILLER   PIC X(7)	    VALUE SPACES.
    71            02 FILLER   PIC X(4)      VALUE 'CODE'.
    72		  02 FILLER   PIC X(8)	    VALUE SPACES.
    73            02 FILLER   PIC X(6)      VALUE 'NUMBER'.
    74		  02 FILLER   PIC X(18)     VALUE SPACES.
    75            02 FILLER   PIC X(4)      VALUE 'NAME'.
    76		  02 FILLER   PIC X(33)     VALUE SPACES.
    77	      01  DETALYE.
    78       * FIX: WAS 'FILER', MUST BE 'FILLER'
    79		  02  FILLER	  PIC X(9)    VALUE SPACES.
    80		  02  P-AC	  PIC X.
    81		  02  FILLER	  PIC X(10)   VALUE SPACES.
    82		  02  P-SNO	  PIC 9(5).
    83		  02  FILLER	  PIC X(8)    VALUE SPACES.
    84		  02  P-SNA	  PIC X(25).
    85       * FIX: WAS 'VALUES', MUST BE 'VALUE'
    86		  02  FILLER	  PIC X(7)    VALUE SPACES.
    87		  02  P-AMT	  PIC 99,999.99.
    88		  02  FILLER	  PIC X(6)    VALUE SPACES.
    89	      01  TOTAL-1.
    90		  02 FILLER   PIC X(7)	    VALUE SPACES.
    91            02 FILLER   PIC X(9)      VALUE 'TOTAL NO.'.
    92            02 FILLER   PIC X(12)     VALUE 'OF SALESMEN:'.
    93		  02 FILLER   PIC X(9)	    VALUE SPACES.
    94		  02 P-TNS    PIC 9,999.
    95		  02 FILLER   PIC X(38)     VALUE SPACES.
    96	      01  TOTAL-2.
    97		  02 FILLER   PIC X(7)	    VALUE SPACES.
    98            02 FILLER   PIC X(6)      VALUE 'TOTAL '.
    99            02 FILLER   PIC X(11)     VALUE 'ACCUMULATED'.
   100            02 FILLER   PIC X(8)      VALUE ' AMOUNT:'.
   101            02 FILLER   PIC X(4)      VALUE ' PHP'.
   102		  02 P-TA     PIC 9,999,999.99.
   103		  02 FILLER   PIC X(33)     VALUE SPACES.
   104
   105	      PROCEDURE DIVISION.
   106	      MAIN-RTN.
   107       * FIX: REMOVED THE 'THRU' CLAUSE FOR SIMPLICITY
   108		  PERFORM INIT-RTN.
   109		  PERFORM PROCESS-RTN UNTIL EOFSW = 1.
   110		  PERFORM FINISH-RTN.
   111		  STOP RUN.
   112
   113	      INIT-RTN.
   114		  OPEN INPUT INFILE,  OUTPUT OUTFILE.
   115	     * PERFORM A PRIMING READ
   116		  READ INFILE
   117		      AT END PERFORM END-RTN.
   118	     * FIX: LOGIC WAS FLAWED. ONLY PROCESS IF FILE IS NOT EMPTY.
   119		  IF EOFSW = 0
   120		      MOVE AC TO SVAC   121		      PERFORM HEADING-RTN.						15NOV25 07:46:38  PAGE	  3
   122	     * NOTE: REMOVED INIT-RTN-END AND GO TO
   123
   124	      END-RTN.
   125		  MOVE 1 TO EOFSW.
   126       * ONLY DISPLAY 'EMPTY FILE' IF NO RECORDS WERE EVER PROCESSED
   127		  IF TNS = 0
   128       * FIX: Removed 'LINE 3 COLUMN 20' as it is invalid syntax
   129	     * without a SCREEN SECTION.
   130                DISPLAY 'EMPTY FILE'.
   131
   132	      HEADING-RTN.
   133		  WRITE OUTREC FROM HEAD-1 AFTER PAGE.
   134		  WRITE OUTREC FROM HEAD-2 AFTER 1.
   135		  WRITE OUTREC FROM SUB-1 AFTER 3.
   136		  WRITE OUTREC FROM SUB-2 AFTER 2.
   137		  WRITE OUTREC FROM SUB-3 AFTER 1.
   138
   139	      PROCESS-RTN.
   140       * FIX: Removed 'DISPLAY SCRE.' because SCRE is not defined
   141	     * since the SCREEN SECTION was removed.
   142            DISPLAY ' '.
   143		  IF SVAC NOT = AC
   144		      PERFORM AC-BREAK-RTN
   145		      PERFORM HEADING-RTN.
   146       * FIX: REMOVED 'END-IF' - it's not supported by Realia COBOL.
   147       * The period added to the 'PERFORM' line above now
   148	     * closes the IF statement for older compilers.
   149
   150		  MOVE AC TO P-AC.
   151		  MOVE SNO TO P-SNO.
   152		  MOVE SNA TO P-SNA.
   153		  MOVE AMT TO P-AMT.
   154		  WRITE OUTREC FROM DETALYE AFTER 1.
   155       * FIX: REMOVED REDUNDANT 'GIVING'
   156		  ADD 1 TO TNS.
   157		  ADD AMT TO TA.
   158	     * FIX: MOVED THE AT END LOGIC TO ITS OWN PARAGRAPH
   159		  READ INFILE
   160		      AT END PERFORM END-OF-FILE-PROCESSING.
   161
   162	      END-OF-FILE-PROCESSING.
   163		  MOVE 1 TO EOFSW.
   164       * PERFORM THE FINAL BREAK TO PRINT THE LAST GROUP'S TOTALS
   165		  PERFORM AC-BREAK-RTN.
   166
   167	      AC-BREAK-RTN.
   168		  MOVE TNS TO P-TNS.
   169		  WRITE OUTREC FROM TOTAL-1 AFTER 3.
   170		  MOVE TA TO P-TA.
   171		  WRITE OUTREC FROM TOTAL-2 AFTER 1.
   172		  MOVE 0 TO TNS, TA.
   173		  MOVE AC TO SVAC.
   174
   175	      FINISH-RTN.
   176		  CLOSE INFILE, OUTFILE.
   177       * FIX: Removed 'LINE 6 COLUMN 20' as it is invalid syntax
   178	     * without a SCREEN SECTION.
   179            DISPLAY 'TAPOS NA'.Realia COBOL Version 4.000   SN: 01-07732  C:TRIAL3.COB 				15NOV25 07:46:38  PAGE	  4



				    Segment Table
			Segment    Number     Length	    Name

			  C00	     05        0350	 SALE$C00
			  D00	     06        04FC	 SALE$D00


			Realia COBOL Compiler Version Information

			      Pass 1	 Version 4.059
			      Pass 1a	 Version 4.025
			      Pass 2	 Version 4.059
			      Pass 2a	 Version 4.024
			      Pass 3	 Version 4.083
			      Pass 4	 Version 4.028


			Compilation Directives in Effect

				    COMP-4
				    NODCHK
				      OPT
				    NOCALL
				    NOSUBCHK
				      STRCHK
				      ANSITRUNC
				    NOSMALLCOMP
				    NODCALL
				    NODIVZERO
				    NOEPDCALL
				      APOST
				      ASCII
				      STATABORT
				      MOVELINK
				    NOBLL4K
				      ARGCHK
				      UPLOW
				      WRITEAFTER
				      SOSI
				      DIALECT-REALIA4

				    ERROR LEVEL LIMIT: W

			Source lines compiled:	     179
			Compilation time (mm:ss.hh):  0:19.28
			Compilation speed (lines/minute):   557

			Compilation date (yy/mm/dd): 25/11/15
			     Time of day (hh:mm:ss): 07:46:39

			Source length in LST file:000007309