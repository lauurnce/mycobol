     1	      IDENTIFICATION DIVISION.							28NOV25 09:09:09  PAGE	  1
     2	      PROGRAM-ID. BANK-REPORT.
     3	      AUTHOR.	  LAWRENCE LIBRADO PANES.
     4
     5	      ENVIRONMENT DIVISION.
     6	      INPUT-OUTPUT SECTION.
     7	      FILE-CONTROL.
     8            SELECT TRANS-FILE ASSIGN TO "TRANS1.TXT"
     9		      ORGANIZATION IS SEQUENTIAL.
    10
    11            SELECT REPORT-FILE ASSIGN TO "REPORT.TXT"
    12		      ORGANIZATION IS SEQUENTIAL.
    13
    14	      DATA DIVISION.
    15	      FILE SECTION.
    16	      FD  TRANS-FILE.
    17	      01  TRANS-REC.
    18		  05 TR-ACCT-NO        PIC X(10).
    19		  05 TR-ACCT-NAME      PIC X(25).
    20		  05 TR-CODE	       PIC X.
    21               88 IS-DEPOSIT     VALUE 'D'.
    22               88 IS-WITHDRAWAL  VALUE 'W'.
    23		  05 TR-AMOUNT	       PIC 9(7)V99.
    24		  05 FILLER	       PIC X(2).
    25
    26	      FD  REPORT-FILE.
    27	      01  PRINT-LINE	       PIC X(80).
    28
    29	      WORKING-STORAGE SECTION.
    30	      01  WS-FLAGS.
    31            05 WS-EOF            PIC X VALUE 'N'.
    32               88 END-OF-FILE    VALUE 'Y'.
    33
    34	      01  WS-HOLDERS.
    35		  05 PREV-ACCT-NO      PIC X(10) VALUE SPACES.
    36		  05 PREV-ACCT-NAME    PIC X(25) VALUE SPACES.
    37
    38	      01  WS-CALCS.
    39		  05 WS-ACCT-BALANCE   PIC S9(7)V99 VALUE 0.
    40		  05 WS-TOTAL-BALANCE  PIC S9(10)V99 VALUE 0.
    41		  05 WS-REC-COUNT      PIC 9(4) VALUE 0.
    42		  05 LINES-REMAINING   PIC 9(2) VALUE 10.
    43
    44	      01  HEADING-1.
    45		  05 FILLER	       PIC X(32) VALUE SPACES.
    46            05 FILLER            PIC X(16) VALUE "China Trust Bank".
    47		  05 FILLER	       PIC X(32) VALUE SPACES.
    48
    49	      01  HEADING-2.
    50		  05 FILLER	       PIC X(33) VALUE SPACES.
    51            05 FILLER            PIC X(13) VALUE "Makati Avenue".
    52		  05 FILLER	       PIC X(34) VALUE SPACES.
    53
    54	      01  HEADING-3.
    55		  05 FILLER	       PIC X(34) VALUE SPACES.
    56            05 FILLER            PIC X(11) VALUE "Makati City".
    57		  05 FILLER	       PIC X(35) VALUE SPACES.
    58
    59	      01  HEADING-4.
    60		  05 FILLER	       PIC X(32) VALUE SPACES.    61            05 FILLER            PIC X(16) VALUE "Account's Report".              28NOV25 09:09:09  PAGE    2
    62		  05 FILLER	       PIC X(32) VALUE SPACES.
    63
    64	      01  HEADING-5.
    65		  05 FILLER	       PIC X(12) VALUE SPACES.
    66            05 FILLER            PIC X(7)  VALUE "Account".
    67		  05 FILLER	       PIC X(14) VALUE SPACES.
    68            05 FILLER            PIC X(7)  VALUE "Account".
    69		  05 FILLER	       PIC X(20) VALUE SPACES.
    70            05 FILLER            PIC X(7)  VALUE "Balance".
    71		  05 FILLER	       PIC X(13) VALUE SPACES.
    72
    73	      01  HEADING-6.
    74		  05 FILLER	       PIC X(12) VALUE SPACES.
    75            05 FILLER            PIC X(6)  VALUE "Number".
    76		  05 FILLER	       PIC X(15) VALUE SPACES.
    77            05 FILLER            PIC X(4)  VALUE "Name".
    78		  05 FILLER	       PIC X(43) VALUE SPACES.
    79
    80	      01  DETAIL-LINE.
    81		  05 FILLER	       PIC X(10) VALUE SPACES.
    82		  05 DL-ACCT-NO        PIC X(10).
    83		  05 FILLER	       PIC X(10) VALUE SPACES.
    84		  05 DL-ACCT-NAME      PIC X(25).
    85		  05 FILLER	       PIC X(8)  VALUE SPACES.
    86		  05 DL-BALANCE        PIC ZZZ,ZZZ,ZZ9.99.
    87		  05 FILLER	       PIC X(3)  VALUE SPACES.
    88
    89	      01  FOOTER-COUNT.
    90		  05 FILLER	       PIC X(7)  VALUE SPACES.
    91		  05 FILLER	       PIC X(29) VALUE
    92               "Total No. of Records printed:".
    93		  05 FILLER	       PIC X(1)  VALUE SPACE.
    94
    95		  05 FT-COUNT	       PIC ZZZ9.
    96
    97		  05 FILLER	       PIC X(39) VALUE SPACES.
    98
    99	      01  FOOTER-TOTAL.
   100		  05 FILLER	       PIC X(7)  VALUE SPACES.
   101		  05 FILLER	       PIC X(28) VALUE
   102               "Total Accumulated Balance: P".
   103		  05 FILLER	       PIC X(1)  VALUE SPACE.
   104		  05 FT-TOTAL-BAL      PIC Z,ZZZ,ZZZ,ZZ9.99.
   105		  05 FILLER	       PIC X(30) VALUE SPACES.
   106
   107	      PROCEDURE DIVISION.
   108	      000-MAIN-LOGIC.
   109		  OPEN INPUT TRANS-FILE
   110		       OUTPUT REPORT-FILE.
   111
   112		  PERFORM 100-PRINT-HEADINGS.
   113
   114		  READ TRANS-FILE
   115		      AT END SET END-OF-FILE TO TRUE
   116		  END-READ.
   117
   118		  IF NOT END-OF-FILE
   119		      MOVE TR-ACCT-NO TO PREV-ACCT-NO
   120		      MOVE TR-ACCT-NAME TO PREV-ACCT-NAME   121		  END-IF.								28NOV25 09:09:09  PAGE	  3
   122
   123		  PERFORM 200-PROCESS-DATA UNTIL END-OF-FILE.
   124
   125		  IF PREV-ACCT-NO NOT = SPACES
   126		      PERFORM 300-PRINT-DETAIL
   127		  END-IF.
   128
   129		  PERFORM 400-PRINT-FOOTER.
   130
   131		  CLOSE TRANS-FILE
   132			REPORT-FILE.
   133		  STOP RUN.
   134
   135	      100-PRINT-HEADINGS.
   136		  MOVE 10 TO LINES-REMAINING.
   137		  WRITE PRINT-LINE FROM HEADING-1 AFTER PAGE.
   138		  WRITE PRINT-LINE FROM HEADING-2 AFTER 1.
   139		  WRITE PRINT-LINE FROM HEADING-3 AFTER 1.
   140
   141		  MOVE SPACES TO PRINT-LINE.
   142		  WRITE PRINT-LINE.
   143		  WRITE PRINT-LINE.
   144
   145		  WRITE PRINT-LINE FROM HEADING-4.
   146
   147		  MOVE SPACES TO PRINT-LINE.
   148		  WRITE PRINT-LINE.
   149
   150		  WRITE PRINT-LINE FROM HEADING-5.
   151		  WRITE PRINT-LINE FROM HEADING-6.
   152
   153		  MOVE SPACES TO PRINT-LINE.
   154		  WRITE PRINT-LINE.
   155
   156	      200-PROCESS-DATA.
   157		  IF TR-ACCT-NO NOT = PREV-ACCT-NO
   158		      PERFORM 300-PRINT-DETAIL
   159		      MOVE 0 TO WS-ACCT-BALANCE
   160		      MOVE TR-ACCT-NO TO PREV-ACCT-NO
   161		      MOVE TR-ACCT-NAME TO PREV-ACCT-NAME
   162		  END-IF.
   163
   164		  IF IS-DEPOSIT
   165		      ADD TR-AMOUNT TO WS-ACCT-BALANCE
   166		  ELSE
   167		      IF IS-WITHDRAWAL
   168			  SUBTRACT TR-AMOUNT FROM WS-ACCT-BALANCE
   169		      END-IF
   170		  END-IF.
   171
   172		  READ TRANS-FILE
   173		      AT END SET END-OF-FILE TO TRUE
   174		  END-READ.
   175
   176	      300-PRINT-DETAIL.
   177		  IF LINES-REMAINING = 0
   178		      PERFORM 100-PRINT-HEADINGS
   179		  END-IF.
   180   181		  MOVE PREV-ACCT-NO TO DL-ACCT-NO.					28NOV25 09:09:09  PAGE	  4
   182		  MOVE PREV-ACCT-NAME TO DL-ACCT-NAME.
   183		  MOVE WS-ACCT-BALANCE TO DL-BALANCE.
   184
   185		  WRITE PRINT-LINE FROM DETAIL-LINE AFTER 1.
   186		  SUBTRACT 1 FROM LINES-REMAINING.
   187
   188		  ADD 1 TO WS-REC-COUNT.
   189		  ADD WS-ACCT-BALANCE TO WS-TOTAL-BALANCE.
   190
   191	      400-PRINT-FOOTER.
   192		  MOVE SPACES TO PRINT-LINE.
   193		  WRITE PRINT-LINE.
   194		  WRITE PRINT-LINE.
   195
   196		  MOVE WS-REC-COUNT TO FT-COUNT.
   197		  WRITE PRINT-LINE FROM FOOTER-COUNT.
   198
   199		  MOVE WS-TOTAL-BALANCE TO FT-TOTAL-BAL.
   200		  WRITE PRINT-LINE FROM FOOTER-TOTAL.Realia COBOL Version 4.000   SN: 01-07732  C:BANK1.COB					28NOV25 09:09:09  PAGE	  5



				    Segment Table
			Segment    Number     Length	    Name

			  C00	     05        04A8	 BANK$REPORT$C00
			  D00	     06        0575	 BANK$REPORT$D00


			Realia COBOL Compiler Version Information

			      Pass 1	 Version 4.059
			      Pass 1a	 Version 4.025
			      Pass 2	 Version 4.059
			      Pass 2a	 Version 4.024
			      Pass 3	 Version 4.083
			      Pass 4	 Version 4.028


			Compilation Directives in Effect

				    COMP-4
				    NODCHK
				      OPT
				    NOCALL
				    NOSUBCHK
				      STRCHK
				      ANSITRUNC
				    NOSMALLCOMP
				    NODCALL
				    NODIVZERO
				    NOEPDCALL
				      APOST
				      ASCII
				      STATABORT
				      MOVELINK
				    NOBLL4K
				      ARGCHK
				      UPLOW
				      WRITEAFTER
				      SOSI
				      DIALECT-REALIA4

				    ERROR LEVEL LIMIT: W

			Source lines compiled:	     200
			Compilation time (mm:ss.hh):  0:03.63
			Compilation speed (lines/minute):  3305

			Compilation date (yy/mm/dd): 25/11/28
			     Time of day (hh:mm:ss): 09:09:09

			Source length in LST file:000007203