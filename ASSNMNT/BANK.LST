     1	      IDENTIFICATION DIVISION.							25NOV25 02:25:22  PAGE	  1
     2	      PROGRAM-ID. BANK-REPORT.
     3	     *AUTHOR.	  LAWRENCE PANES.
     4
     5	      ENVIRONMENT DIVISION.
     6	      INPUT-OUTPUT SECTION.
     7	      FILE-CONTROL.
     8            SELECT TRANS-FILE ASSIGN TO "transactions.txt"
     9		      ORGANIZATION IS SEQUENTIAL.
    10
    11            SELECT REPORT-FILE ASSIGN TO "report.out"
    12		      ORGANIZATION IS SEQUENTIAL.
    13
    14	      DATA DIVISION.
    15	      FILE SECTION.
    16	      FD  TRANS-FILE.
    17	      01  TRANS-REC.
    18		  05 TR-ACCT-NO        PIC X(10).
    19		  05 TR-ACCT-NAME      PIC X(25).
    20		  05 TR-CODE	       PIC X.
    21               88 IS-DEPOSIT     VALUE 'D'.
    22               88 IS-WITHDRAWAL  VALUE 'W'.
    23		  05 TR-AMOUNT	       PIC 9(7)V99.
    24		  05 FILLER PIC X(2).
    25
    26	      FD  REPORT-FILE.
    27	      01  PRINT-LINE	       PIC X(80).
    28
    29	      WORKING-STORAGE SECTION.
    30	      01  WS-FLAGS.
    31            05 WS-EOF            PIC X VALUE 'N'.
    32               88 END-OF-FILE    VALUE 'Y'.
    33
    34	      01  WS-HOLDERS.
    35		  05 PREV-ACCT-NO      PIC X(10) VALUE SPACES.
    36		  05 PREV-ACCT-NAME    PIC X(25) VALUE SPACES.
    37
    38	      01  WS-CALCS.
    39		  05 WS-ACCT-BALANCE   PIC S9(7)V99 VALUE 0.
    40		  05 WS-TOTAL-BALANCE  PIC S9(10)V99 VALUE 0.
    41		  05 WS-REC-COUNT      PIC 9(4) VALUE 0.
    42
    43	      01  HEADING-1.
    44		  05 FILLER	       PIC X(32) VALUE SPACES.
    45            05 FILLER            PIC X(16) VALUE "China Trust Bank".
    46		  05 FILLER	       PIC X(32) VALUE SPACES.
    47
    48	      01  HEADING-2.
    49		  05 FILLER	       PIC X(33) VALUE SPACES.
    50            05 FILLER            PIC X(13) VALUE "Makati Avenue".
    51		  05 FILLER	       PIC X(34) VALUE SPACES.
    52
    53	      01  HEADING-3.
    54		  05 FILLER	       PIC X(34) VALUE SPACES.
    55            05 FILLER            PIC X(11) VALUE "Makati City".
    56		  05 FILLER	       PIC X(35) VALUE SPACES.
    57
    58	      01  HEADING-4.
    59		  05 FILLER	       PIC X(32) VALUE SPACES.
    60            05 FILLER            PIC X(16) VALUE "Account's Report".    61		  05 FILLER	       PIC X(32) VALUE SPACES.				25NOV25 02:25:22  PAGE	  2
    62
    63	      01  HEADING-5.
    64		  05 FILLER	       PIC X(5)  VALUE SPACES.
    65            05 FILLER            PIC X(7)  VALUE "Account".
    66		  05 FILLER	       PIC X(24) VALUE SPACES.
    67            05 FILLER            PIC X(7)  VALUE "Account".
    68		  05 FILLER	       PIC X(20) VALUE SPACES.
    69            05 FILLER            PIC X(7)  VALUE "Balance".
    70		  05 FILLER	       PIC X(10) VALUE SPACES.
    71
    72	      01  HEADING-6.
    73		  05 FILLER	       PIC X(5)  VALUE SPACES.
    74            05 FILLER            PIC X(6)  VALUE "Number".
    75		  05 FILLER	       PIC X(25) VALUE SPACES.
    76            05 FILLER            PIC X(4)  VALUE "Name".
    77		  05 FILLER	       PIC X(40) VALUE SPACES.
    78
    79	      01  HEADING-7.
    80		  05 FILLER	       PIC X(5)  VALUE SPACES.
    81            05 FILLER            PIC X(5)  VALUE "X(10)".
    82		  05 FILLER	       PIC X(26) VALUE SPACES.
    83            05 FILLER            PIC X(5)  VALUE "X(25)".
    84		  05 FILLER	       PIC X(18) VALUE SPACES.
    85            05 FILLER            PIC X(14) VALUE "ZZZ,ZZZ,ZZ9.99".
    86		  05 FILLER	       PIC X(7)  VALUE SPACES.
    87
    88	      01  DETAIL-LINE.
    89		  05 FILLER	       PIC X(5)  VALUE SPACES.
    90		  05 DL-ACCT-NO        PIC X(10).
    91		  05 FILLER	       PIC X(10) VALUE SPACES.
    92		  05 DL-ACCT-NAME      PIC X(25).
    93		  05 FILLER	       PIC X(5)  VALUE SPACES.
    94		  05 DL-BALANCE        PIC Z,ZZZ,ZZ9.99.
    95		  05 FILLER	       PIC X(10) VALUE SPACES.
    96
    97	      01  FOOTER-COUNT.
    98		  05 FILLER	       PIC X(5)  VALUE SPACES.
    99		  05 FILLER	       PIC X(29) VALUE
   100               "Total No. of Records printed:".
   101		  05 FILLER	       PIC X(1)  VALUE SPACE.
   102		  05 FT-COUNT	       PIC ZZZ9.
   103		  05 FILLER	       PIC X(40) VALUE SPACES.
   104
   105	      01  FOOTER-TOTAL.
   106		  05 FILLER	       PIC X(5)  VALUE SPACES.
   107		  05 FILLER	       PIC X(27) VALUE
   108               "Total Accumulated Balance: ".
   109            05 FILLER            PIC X(2)  VALUE "P ".
   110		  05 FT-TOTAL-BAL      PIC Z,ZZZ,ZZZ,ZZ9.99.
   111		  05 FILLER	       PIC X(25) VALUE SPACES.
   112
   113	      PROCEDURE DIVISION.
   114	      000-MAIN-LOGIC.
   115		  OPEN INPUT TRANS-FILE
   116		       OUTPUT REPORT-FILE.
   117
   118		  PERFORM 100-PRINT-HEADINGS.
   119
   120		  READ TRANS-FILE   121		      AT END SET END-OF-FILE TO TRUE					25NOV25 02:25:22  PAGE	  3
   122		  END-READ.
   123
   124		  IF NOT END-OF-FILE
   125		      MOVE TR-ACCT-NO TO PREV-ACCT-NO
   126		      MOVE TR-ACCT-NAME TO PREV-ACCT-NAME
   127		  END-IF.
   128
   129		  PERFORM 200-PROCESS-DATA UNTIL END-OF-FILE.
   130
   131		  IF PREV-ACCT-NO NOT = SPACES
   132		      PERFORM 300-PRINT-DETAIL
   133		  END-IF.
   134
   135		  PERFORM 400-PRINT-FOOTER.
   136
   137		  CLOSE TRANS-FILE
   138			REPORT-FILE.
   139		  STOP RUN.
   140
   141	      100-PRINT-HEADINGS.
   142		  WRITE PRINT-LINE FROM HEADING-1.
   143		  WRITE PRINT-LINE FROM HEADING-2.
   144		  WRITE PRINT-LINE FROM HEADING-3.
   145
   146		  MOVE SPACES TO PRINT-LINE.
   147		  WRITE PRINT-LINE.
   148		  WRITE PRINT-LINE.
   149
   150		  WRITE PRINT-LINE FROM HEADING-4.
   151
   152		  MOVE SPACES TO PRINT-LINE.
   153		  WRITE PRINT-LINE.
   154
   155		  WRITE PRINT-LINE FROM HEADING-5.
   156		  WRITE PRINT-LINE FROM HEADING-6.
   157		  WRITE PRINT-LINE FROM HEADING-7.
   158
   159		  MOVE SPACES TO PRINT-LINE.
   160		  WRITE PRINT-LINE.
   161
   162	      200-PROCESS-DATA.
   163		  IF TR-ACCT-NO NOT = PREV-ACCT-NO
   164		      PERFORM 300-PRINT-DETAIL
   165		      MOVE 0 TO WS-ACCT-BALANCE
   166		      MOVE TR-ACCT-NO TO PREV-ACCT-NO
   167		      MOVE TR-ACCT-NAME TO PREV-ACCT-NAME
   168		  END-IF.
   169
   170		  IF IS-DEPOSIT
   171		      ADD TR-AMOUNT TO WS-ACCT-BALANCE
   172		  ELSE
   173		      IF IS-WITHDRAWAL
   174			  SUBTRACT TR-AMOUNT FROM WS-ACCT-BALANCE
   175		      END-IF
   176		  END-IF.
   177
   178		  READ TRANS-FILE
   179		      AT END SET END-OF-FILE TO TRUE
   180		  END-READ.   181											25NOV25 02:25:22  PAGE	  4
   182	      300-PRINT-DETAIL.
   183		  MOVE PREV-ACCT-NO TO DL-ACCT-NO.
   184		  MOVE PREV-ACCT-NAME TO DL-ACCT-NAME.
   185		  MOVE WS-ACCT-BALANCE TO DL-BALANCE.
   186
   187		  WRITE PRINT-LINE FROM DETAIL-LINE.
   188
   189		  ADD 1 TO WS-REC-COUNT.
   190		  ADD WS-ACCT-BALANCE TO WS-TOTAL-BALANCE.
   191
   192	      400-PRINT-FOOTER.
   193		  MOVE SPACES TO PRINT-LINE.
   194		  WRITE PRINT-LINE.
   195		  WRITE PRINT-LINE.
   196
   197		  MOVE WS-REC-COUNT TO FT-COUNT.
   198		  WRITE PRINT-LINE FROM FOOTER-COUNT.
   199
   200		  MOVE WS-TOTAL-BALANCE TO FT-TOTAL-BAL.
   201		  WRITE PRINT-LINE FROM FOOTER-TOTAL.Realia COBOL Version 4.000   SN: 01-07732  C:BANK.COB					25NOV25 02:25:22  PAGE	  5



				    Segment Table
			Segment    Number     Length	    Name

			  C00	     05        0481	 BANK$REPORT$C00
			  D00	     06        05BB	 BANK$REPORT$D00


			Realia COBOL Compiler Version Information

			      Pass 1	 Version 4.059
			      Pass 1a	 Version 4.025
			      Pass 2	 Version 4.059
			      Pass 2a	 Version 4.024
			      Pass 3	 Version 4.083
			      Pass 4	 Version 4.028


			Compilation Directives in Effect

				    COMP-4
				    NODCHK
				      OPT
				    NOCALL
				    NOSUBCHK
				      STRCHK
				      ANSITRUNC
				    NOSMALLCOMP
				    NODCALL
				    NODIVZERO
				    NOEPDCALL
				      APOST
				      ASCII
				      STATABORT
				      MOVELINK
				    NOBLL4K
				      ARGCHK
				      UPLOW
				      WRITEAFTER
				      SOSI
				      DIALECT-REALIA4

				    ERROR LEVEL LIMIT: W

			Source lines compiled:	     201
			Compilation time (mm:ss.hh):  0:03.46
			Compilation speed (lines/minute):  3485

			Compilation date (yy/mm/dd): 25/11/25
			     Time of day (hh:mm:ss): 02:25:23

			Source length in LST file:000007399