     1	      IDENTIFICATION DIVISION.							25NOV25 03:20:09  PAGE	  1
     2	      PROGRAM-ID. BANK-REPORT.
     3	     *AUTHOR.	  LAWRENCE PANES.
     4
     5	      ENVIRONMENT DIVISION.
     6	      INPUT-OUTPUT SECTION.
     7	      FILE-CONTROL.
     8            SELECT TRANS-FILE ASSIGN TO "TRANS.TXT"
     9		      ORGANIZATION IS SEQUENTIAL.
    10
    11            SELECT REPORT-FILE ASSIGN TO "REPORT.OUT"
    12		      ORGANIZATION IS SEQUENTIAL.
    13
    14	      DATA DIVISION.
    15	      FILE SECTION.
    16	      FD  TRANS-FILE.
    17	      01  TRANS-REC.
    18		  05 TR-ACCT-NO        PIC X(10).
    19		  05 TR-ACCT-NAME      PIC X(25).
    20		  05 TR-CODE	       PIC X.
    21               88 IS-DEPOSIT     VALUE 'D'.
    22               88 IS-WITHDRAWAL  VALUE 'W'.
    23		  05 TR-AMOUNT	       PIC 9(7)V99.
    24		  05 FILLER	       PIC X(2).
    25
    26	      FD  REPORT-FILE.
    27	      01  PRINT-LINE	       PIC X(80).
    28
    29	      WORKING-STORAGE SECTION.
    30	      01  WS-FLAGS.
    31            05 WS-EOF            PIC X VALUE 'N'.
    32               88 END-OF-FILE    VALUE 'Y'.
    33
    34	      01  WS-HOLDERS.
    35		  05 PREV-ACCT-NO      PIC X(10) VALUE SPACES.
    36		  05 PREV-ACCT-NAME    PIC X(25) VALUE SPACES.
    37
    38	      01  WS-CALCS.
    39		  05 WS-ACCT-BALANCE   PIC S9(7)V99 VALUE 0.
    40		  05 WS-TOTAL-BALANCE  PIC S9(10)V99 VALUE 0.
    41		  05 WS-REC-COUNT      PIC 9(4) VALUE 0.
    42
    43	      01  HEADING-1.
    44		  05 FILLER	       PIC X(32) VALUE SPACES.
    45            05 FILLER            PIC X(16) VALUE "China Trust Bank".
    46		  05 FILLER	       PIC X(32) VALUE SPACES.
    47
    48	      01  HEADING-2.
    49		  05 FILLER	       PIC X(33) VALUE SPACES.
    50            05 FILLER            PIC X(13) VALUE "Makati Avenue".
    51		  05 FILLER	       PIC X(34) VALUE SPACES.
    52
    53	      01  HEADING-3.
    54		  05 FILLER	       PIC X(34) VALUE SPACES.
    55            05 FILLER            PIC X(11) VALUE "Makati City".
    56		  05 FILLER	       PIC X(35) VALUE SPACES.
    57
    58	      01  HEADING-4.
    59		  05 FILLER	       PIC X(17) VALUE SPACES.
    60            05 FILLER            PIC X(16) VALUE "Account's Report".    61		  05 FILLER	       PIC X(47) VALUE SPACES.				25NOV25 03:20:09  PAGE	  2
    62
    63	      01  HEADING-5.
    64		  05 FILLER	       PIC X(4)  VALUE SPACES.
    65            05 FILLER            PIC X(7)  VALUE "Account".
    66		  05 FILLER	       PIC X(25) VALUE SPACES.
    67            05 FILLER            PIC X(7)  VALUE "Account".
    68		  05 FILLER	       PIC X(16) VALUE SPACES.
    69            05 FILLER            PIC X(7)  VALUE "Balance".
    70		  05 FILLER	       PIC X(15) VALUE SPACES.
    71
    72	      01  HEADING-6.
    73		  05 FILLER	       PIC X(8)  VALUE SPACES.
    74            05 FILLER            PIC X(6)  VALUE "Number".
    75		  05 FILLER	       PIC X(23) VALUE SPACES.
    76            05 FILLER            PIC X(4)  VALUE "Name".
    77		  05 FILLER	       PIC X(39) VALUE SPACES.
    78
    79	      01  DETAIL-LINE.
    80		  05 FILLER	       PIC X(4)  VALUE SPACES.
    81		  05 DL-ACCT-NO        PIC X(10).
    82		  05 FILLER	       PIC X(10) VALUE SPACES.
    83		  05 DL-ACCT-NAME      PIC X(25).
    84		  05 FILLER	       PIC X(2)  VALUE SPACES.
    85		  05 DL-BALANCE        PIC Z,ZZZ,ZZ9.99.
    86		  05 FILLER	       PIC X(14) VALUE SPACES.
    87
    88	      01  FOOTER-COUNT.
    89		  05 FILLER	       PIC X(4)  VALUE SPACES.
    90		  05 FILLER	       PIC X(29) VALUE
    91               "Total No. of Records printed:".
    92		  05 FILLER	       PIC X(1)  VALUE SPACE.
    93		  05 FT-COUNT	       PIC ZZZ9.
    94		  05 FILLER	       PIC X(41) VALUE SPACES.
    95
    96	      01  FOOTER-TOTAL.
    97		  05 FILLER	       PIC X(4)  VALUE SPACES.
    98		  05 FILLER	       PIC X(27) VALUE
    99               "Total Accumulated Balance: ".
   100            05 FILLER            PIC X(1)  VALUE "P".
   101		  05 FT-TOTAL-BAL      PIC Z,ZZZ,ZZZ,ZZ9.99.
   102		  05 FILLER	       PIC X(26) VALUE SPACES.
   103
   104	      PROCEDURE DIVISION.
   105	      000-MAIN-LOGIC.
   106		  OPEN INPUT TRANS-FILE
   107		       OUTPUT REPORT-FILE.
   108
   109		  PERFORM 100-PRINT-HEADINGS.
   110
   111		  READ TRANS-FILE
   112		      AT END SET END-OF-FILE TO TRUE
   113		  END-READ.
   114
   115		  IF NOT END-OF-FILE
   116		      MOVE TR-ACCT-NO TO PREV-ACCT-NO
   117		      MOVE TR-ACCT-NAME TO PREV-ACCT-NAME
   118		  END-IF.
   119
   120		  PERFORM 200-PROCESS-DATA UNTIL END-OF-FILE.   121											25NOV25 03:20:09  PAGE	  3
   122		  IF PREV-ACCT-NO NOT = SPACES
   123		      PERFORM 300-PRINT-DETAIL
   124		  END-IF.
   125
   126		  PERFORM 400-PRINT-FOOTER.
   127
   128		  CLOSE TRANS-FILE
   129			REPORT-FILE.
   130		  STOP RUN.
   131
   132	      100-PRINT-HEADINGS.
   133		  WRITE PRINT-LINE FROM HEADING-1.
   134		  WRITE PRINT-LINE FROM HEADING-2.
   135		  WRITE PRINT-LINE FROM HEADING-3.
   136
   137		  MOVE SPACES TO PRINT-LINE.
   138		  WRITE PRINT-LINE.
   139		  WRITE PRINT-LINE.
   140
   141		  WRITE PRINT-LINE FROM HEADING-4.
   142
   143		  MOVE SPACES TO PRINT-LINE.
   144		  WRITE PRINT-LINE.
   145
   146		  WRITE PRINT-LINE FROM HEADING-5.
   147		  WRITE PRINT-LINE FROM HEADING-6.
   148
   149		  MOVE SPACES TO PRINT-LINE.
   150		  WRITE PRINT-LINE.
   151
   152	      200-PROCESS-DATA.
   153		  IF TR-ACCT-NO NOT = PREV-ACCT-NO
   154		      PERFORM 300-PRINT-DETAIL
   155		      MOVE 0 TO WS-ACCT-BALANCE
   156		      MOVE TR-ACCT-NO TO PREV-ACCT-NO
   157		      MOVE TR-ACCT-NAME TO PREV-ACCT-NAME
   158		  END-IF.
   159
   160		  IF IS-DEPOSIT
   161		      ADD TR-AMOUNT TO WS-ACCT-BALANCE
   162		  ELSE
   163		      IF IS-WITHDRAWAL
   164			  SUBTRACT TR-AMOUNT FROM WS-ACCT-BALANCE
   165		      END-IF
   166		  END-IF.
   167
   168		  READ TRANS-FILE
   169		      AT END SET END-OF-FILE TO TRUE
   170		  END-READ.
   171
   172	      300-PRINT-DETAIL.
   173		  MOVE PREV-ACCT-NO TO DL-ACCT-NO.
   174		  MOVE PREV-ACCT-NAME TO DL-ACCT-NAME.
   175		  MOVE WS-ACCT-BALANCE TO DL-BALANCE.
   176
   177		  WRITE PRINT-LINE FROM DETAIL-LINE.
   178
   179		  ADD 1 TO WS-REC-COUNT.
   180		  ADD WS-ACCT-BALANCE TO WS-TOTAL-BALANCE.   181											25NOV25 03:20:09  PAGE	  4
   182	      400-PRINT-FOOTER.
   183		  MOVE SPACES TO PRINT-LINE.
   184		  WRITE PRINT-LINE.
   185		  WRITE PRINT-LINE.
   186
   187		  MOVE WS-REC-COUNT TO FT-COUNT.
   188		  WRITE PRINT-LINE FROM FOOTER-COUNT.
   189
   190		  MOVE WS-TOTAL-BALANCE TO FT-TOTAL-BAL.
   191		  WRITE PRINT-LINE FROM FOOTER-TOTAL.Realia COBOL Version 4.000   SN: 01-07732  C:BANK.COB					25NOV25 03:20:09  PAGE	  5



				    Segment Table
			Segment    Number     Length	    Name

			  C00	     05        0463	 BANK$REPORT$C00
			  D00	     06        0565	 BANK$REPORT$D00


			Realia COBOL Compiler Version Information

			      Pass 1	 Version 4.059
			      Pass 1a	 Version 4.025
			      Pass 2	 Version 4.059
			      Pass 2a	 Version 4.024
			      Pass 3	 Version 4.083
			      Pass 4	 Version 4.028


			Compilation Directives in Effect

				    COMP-4
				    NODCHK
				      OPT
				    NOCALL
				    NOSUBCHK
				      STRCHK
				      ANSITRUNC
				    NOSMALLCOMP
				    NODCALL
				    NODIVZERO
				    NOEPDCALL
				      APOST
				      ASCII
				      STATABORT
				      MOVELINK
				    NOBLL4K
				      ARGCHK
				      UPLOW
				      WRITEAFTER
				      SOSI
				      DIALECT-REALIA4

				    ERROR LEVEL LIMIT: W

			Source lines compiled:	     191
			Compilation time (mm:ss.hh):  0:01.75
			Compilation speed (lines/minute):  6548

			Compilation date (yy/mm/dd): 25/11/25
			     Time of day (hh:mm:ss): 03:20:09

			Source length in LST file:000006911